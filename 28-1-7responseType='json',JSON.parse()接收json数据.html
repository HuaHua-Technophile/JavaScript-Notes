<!DOCTYPE html>
<html lang="zh-CN" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="https://i.328888.xyz/2023/04/14/ixDL13.jpeg"
      type="image/png" />
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <link
      href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0-alpha3/css/bootstrap.css"
      rel="stylesheet" />
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0-alpha3/js/bootstrap.bundle.js"></script>
    <title>28-1-7responseType='json',JSON.parse()接收json数据</title>
  </head>
  <body>
    <button id="btn1">方法一:直接设置从服务器端接收json(需服务器支持)</button>
    <script>
      btn1.onclick = function () {
        let xhr1 = new XMLHttpRequest() || createXHR();
        xhr1.open(
          "GET",
          "https://v2.alapi.cn/api/hitokoto?token=IEc59wK92YGhJp7N"
        );
        xhr1.responseType = "json"; //设置: 接收响应数据的类型为JSON, 就可以不用再手动将返回字符串转换为字符串;
        xhr1.send();
        xhr1.onreadystatechange = function () {
          if (xhr1.readyState === 4 && xhr1.status === 200) {
            console.log(xhr1.response); // 获取响应数据(一个 JSON 对象)
          }
        };
      };
    </script>
    <button id="btn2">
      方法二:接收到XML数据后,使用JSON.parse()方法转换为对象
    </button>
    <script>
      btn2.onclick = function () {
        let xhr2 = new XMLHttpRequest() || createXHR();
        xhr2.open(
          "GET",
          "https://v2.alapi.cn/api/hitokoto?token=IEc59wK92YGhJp7N"
        );
        xhr2.send();
        xhr2.onreadystatechange = function () {
          if (xhr2.readyState === 4 && xhr2.status === 200) {
            console.log(JSON.parse(xhr2.response)); // 获取响应数据(一个XML字符串,再将其转换未对象)
          }
        };
      };
    </script>
  </body>
</html>
